<!DOCTYPE html>

<!--
A basic website that plays youtube videos that can be controlled by a
IR remote. Created for COMP3601 Project
-->
<html lang="en">

<head>
<link rel="stylesheet" href="style.css">
</head>


<body>
<h1>Music player</h1>
<hr>

<h3> Song id:</h3>
<h4> Add new song</h4>
<input type="text" id="nextSong">
<button onclick= "addNewSong(); document.getElementById('nextSong').value = ''"> Add new song </button>
<br><br>
<button onclick= "getPrevSong()"> <img src="https://static.thenounproject.com/png/534333-200.png" width="20"> </button>

<button onclick= "getNextSong()">  <img src="https://static.thenounproject.com/png/534333-200.png" width="20" style="transform:rotate(180deg);"> </button>

<button onclick= "volumeDown()"> <img src="https://www.freeiconspng.com/uploads/volume-icon-19.png" width="20"> </button>

<button onclick= "volumeUp()"> <img src="https://image.flaticon.com/icons/png/512/25/25695.png" width="20"></button>

<button onclick= "playPause()"> <img src="https://lh3.googleusercontent.com/proxy/pL9VB6HbhJ6D-0UyJeig2GsvuqmJ8WdGxXwEHZbekhlJ-lpxPM6rdw9OTpARPEvHSJpNe9_nFu9ucMebn9a5AJCVx3P7KWkduL7IsyPmluBYgFS6xTgN45iwj5oSBDo" id = "playPauseButton" width="20"></button>
<br>

<p id="currSongs"> </p>

<script src="https://w.soundcloud.com/player/api.js" type="text/javascript"></script>

<iframe id="sc-widget" width="100%" height="300" scrolling="no" frameborder="no" allow="autoplay" 
src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/293137345
&auto_play=true
&hide_related=false
&show_comments=false
&show_user=true
&show_reposts=false
&show_teaser=true
&visual=true">
</iframe>


<!-- Based on code from blog post: https://developers.soundcloud.com/blog/html5-widget-api-->
<script type="text/javascript">

    var widgetIframe = document.getElementById('sc-widget');
    var widget       = SC.Widget(widgetIframe);

    var songIDs = ['293137345', '259969488'];
    var index = 0;
    var volume = 10;
    var play = true; 

    (function(){

        widget.bind(SC.Widget.Events.READY, function() {
            widget.setVolume(volume);
            widget.bind(SC.Widget.Events.PLAY, function() {
                // get information about currently playing sound
                widget.setVolume(volume);
                widget.getCurrentSound(function(currentSound) {
                    console.log('sound ' + currentSound.get('') + 'began to play');
                });
            });
            // set new volume level
            
            printSongs();
        });
  }());

    function printSongs() {
        var txt = "";
        document.getElementById("currSongs").innerHTML = songIDs.join("<br>");
    }

    function addNewSong() {
        var videoId = document.getElementById("nextSong").value;
        songIDs.push(videoId);
        printSongs();
    }

    function getNextSong() {
        index++;
        widget.load('https://api.soundcloud.com/tracks/259969488', {
            auto_play: true,
            hide_related: false,
            show_comments: false,
            show_user: true,
            show_reposts: false,
            show_teaser: true,
            visual: true
        })
        printSongs();
    }

    function getPrevSong() {
        index--;
        widgetIframe.src = getUrl(songs[index]);
        printSongs();
    }

    function volumeUp() {
        // get current level of volume
        widget.getVolume(function(volume) {
            widget.setVolume(volume += 10);
        });
    }

    function volumeDown() {
        // get current level of volume
        widget.getVolume(function(volume) {
            widget.setVolume(volume -= 10);
        });
    }
    
    function playPause() {
    	if(play){
        	widget.pause();
            document.getElementById("playPauseButton").src="https://www.pinpng.com/pngs/m/34-346993_play-free-png-image-black-play-button-png.png"; 
            play = false;
		} else {
        	widget.play();
            document.getElementById("playPauseButton").src="https://lh3.googleusercontent.com/proxy/pL9VB6HbhJ6D-0UyJeig2GsvuqmJ8WdGxXwEHZbekhlJ-lpxPM6rdw9OTpARPEvHSJpNe9_nFu9ucMebn9a5AJCVx3P7KWkduL7IsyPmluBYgFS6xTgN45iwj5oSBDo";
            play = true; 
        }
    }

    function getUrl(id) {
        return "https://api.soundcloud.com/tracks/" + id;
    }

</script>
</body>
</html>
